# QIIME 2 Metabolomics GNPS plugin

This is a QIIME 2 plugin to analyze metabolomics data that utilizes GNPS. 

## Background

Mass spectrometry detects molecules via charged surrogates called ions (i.e. mass-to-charge, m/z). MS data contains MS1 spectra (i.e. spectrum of all ions; m/z and their respective abundance) and MS2 spectra (i.e. spectrum of structural fragments of an ion). MS2. spectra are generated by imparting excess internal energy into ions which causes them to fragment. Collision induced dissociation (CID) or higher-energy collision induced dissociation (HCD) are common methods to impart energy via collisions with gas molecules. One can collect both MS1 and MS2 spectra in a single experiment using data dependent acquisition (DDA), a common approach used in untargeted metabolomics. The data contains a series of MS1 spectra from which the n most abundant m/z values are selected and fragmented serially. This cycle continues throughout the analysis of a sample. Often, liquid chromatography (or chemical separation techniques) are combined with mass spectrometry to simplify sample complexity and provide orthogonal information (e.g. retention time). Samples can be compared using either MS1 or MS2 data.

## MS2 Spectral Counts

If one were to collect data using DDA or similar method, multiple MS2 spectra from the sample ion (aka molecule) can be present in the data. One of the initial data analysis processes performed in GNPS (via MScluster) is to collapse identical spectra into a single molecular feature. The number of molecular features per sample, i.e. spectral counts, is used as a semiquantitative estimate.

## MS1 Peak Areas

Fundamentally, spectral abundance observed at at given time in a mass spectrum is related to concentration (imperfectly); however, integration of spectral abundance over time better represents the total amount of material present in the sample. Extraction ion chromatograms (XIC) are generated from all observed m/z in the MS1 of a sample, and the area under the curve (i.e. peak area) are determined via integration. Advantage of comparing samples using the MS1 is that the data can be quantitative as well as more accurately detect molecules, particularly those of low abundance, compared to MS2 (as not all ions will be selected in the top nth most abundant peaks).

# Installation

Lorem Ipsum

# Example Usage

## Input Data Description/Download

Lorem Ipsum

### Manifest File Format

#### Documentation for manifest file

The manifest file specifies the location of the files that will be processed by the metabolomicsgnps plugin. It is a .CSV formatted table that contains two columns (See Figure X below). The first column indicates the ‘sample-id’ for each file, while the second column indicates its corresponding relative file path (relative to where qiime commands are called). The gnps-clustering and the mzmine2-clustering tools are using both the same manifest file.

Figure X. View of the manifest file (.CSV format). The first column indicates the ‘sample-id’ for each file, while the second column indicates its corresponding relative file path. The example file can be [downloaded here](https://github.com/mwang87/q2_metabolomicsgnps/raw/master/q2_metabolomicsgnps/tests/data/manifest.tsv).


<img src="img/manifest_file.png"/>

## Spectrum Count Qualitative Analysis

### Food Cross Sectional Study

### Longitudinal Study

## Feature Based Quantification Analysis

### Food Cross Sectional Study

### Longitudinal Study

